# Домашнее задание к занятию «АСУ предприятия, MES»

### Цель задания

В современном высокотехнологичном мире руководители предприятий всё чаще задумываются о совершенствовании систем анализа данных для снижения стоимости производства товаров и обслуживания оборудования.

Наиболее современные предприятия внедряют в свою инфраструктуру верхний уровень АСУ ТП - MES-системы. Они позволяют более качественно и оперативно управлять производством во всех его сферах.

Инженеры АСУ ТП должны соответствовать современным запросам рынка труда. Именно поэтому знать методы работы с MES-системами просто необходимо. 

После выполнения данного задания вы сможете:

1. Понять принципы работы MES-систем и его места в современной структуре АСУ ТП.
2. Поработать с модулями MES и увидеть их работу на практике.

------

### Чеклист готовности к домашнему заданию

1. Установить MES-систему [Ignition Gateway](https://inductiveautomation.com/downloads/).

<details>
 <summary>Подсказка по установке Ignition (доступна по клику)</summary>
 
Установка Ignition вполне стандартная и не имеет сложностей в реализации. Перейдите по [ссылке](https://inductiveautomation.com/downloads/) и выберите пункт «Download for Windows».
 
 ![image](https://github.com/netology-code/pib-homeworks/blob/main/9.1/MES_4.png)
 
Таким образом вы скачаете файл ignition-8.1.19-windows-64-installer.exe. После этого запустите его и пройдите стандартную процедуру установки.

Для входа на начальную страницу Ignition введите в адресной строке браузера *localhost:8088*. Браузер переведёт вас на начальную страницу. 

Ваши действия по начальной настройке:

1. Из предложенных вариантов выберите **Ignition**.
2. На странице лицензионного соглашения выберите **I have read and agree with the terms and conditions** и нажмите **Next**.
3. На странице создания нового пользователя введите имя пользователя (поле **Username**), пароль (поле **Enter Password**) и подтверждение пароля (поле **Confirm Password**).
4. На странице конфигурации портов оставьте значения по умолчанию.
5. Нажмите **Start Gateway**.
6. Если вы хотите получить начальный экран с примерами, то нажмите **Yes, Enable Quick Start**. Если не нужно - нажмите **No, thanks, I`d like to start from scratch**. 

**Установка MES-системы Ignition завершена!**
 
 **ВНИМАНИЕ! Во избежание проблем с запуском Igntion необходимо использовать следующие браузеры: Google Chrome, Microsoft Edge, Opera. Эти браузеры проверены, и система Ignition на них запускается. На Yandex.Браузере данная система не работает!**

</details>

2. Установить [MySQL Server](https://dev.mysql.com/downloads/windows/installer/8.0.html) и [MySQL Workbench](https://dev.mysql.com/downloads/workbench/) (для задания со *).

<details>
 <summary>Подсказка по установке MySQL Server и MySQL Workbench (доступна по клику)</summary>

MySQL Server и MySQL Workbench - это компоненты для работы с базами данных.

MySQL ConnectorJ - это драйвер для связи Ignition и MySQL.

Для установки MySQL Server:

1. Перейдите по [ссылке](https://dev.mysql.com/downloads/windows/installer/8.0.html) на страницу установки программы. 
2. В выпадающем меню выберите вашу операционную систему и тип дистрибутива - **WEB-пакет** (устанавливается по сети Интернет) или **стандартный инсталяционный пакет** (имеет больший размер, однако для установки не требует подключение к сети Интернет).
3. Нажмите на соответствующую кнопку **«DOWNLOAD»**.
 
![image](https://github.com/netology-code/pib-homeworks/blob/main/9.1/MES_3.png)
 
4. Далее пройдите стандартную процедуру установки MySQL Server.

После этого установите MySQL Workbench:
1. Для этого перейдите по [ссылке](https://dev.mysql.com/downloads/workbench/) на страницу установки программы. 
2. В выпадающем меню выберите вашу операционную систему и нажмите на кнопку **«DOWNLOAD»**.
 
![image](https://github.com/netology-code/pib-homeworks/blob/main/9.1/MES_1.png)
 
3. Далее пройдите стандартную процедуру установки MySQL Workbench.

После установки создайте новую базу данных (New Scheme) с именем mes.
 
**Установка базы данных завершена!**

</details>

3. Установить [MES-модули, необходимые для работы](https://www.sepasoft.com/downloads/) (для задания со *).

<details>
 <summary>Подсказка по установке MES-модулей (доступна по клику)</summary>
 
Модули для Ignition доступны по [ссылке](https://www.sepasoft.com/downloads/). Разверните список **MES Platform 3.0 Stable Release**.
 
 ![image](https://github.com/netology-code/pib-homeworks/blob/main/9.1/MES_2.png)
 
Все модули представлены в формате *.modl. После их скачивания вы сможете установить их в вашу MES-систему.
 
**Необходимые модули:**
 1. **PRODUCTION MODULE** (Первый модуль. Поверх него устанавливается все остальные модули)
 2. **BATCH PROCEDURE**
 3. **OEE DOWNTIME**
 4. **TRACK & TRACE**
 5. **SETTINGS & CHANGEOVER**
 6. **SPC**
 7. **DOCUMENT MANAGER**
 
 Для установки модулей необходимо выполнить следующий алгоритм действий:
 
 1. Перейти в меню **Config - System - Modules**.
 2. В открывшемся окне нажать кнопку **Выберите файл**.
 3. Выбрать необходимый модуль для установки (Production Module) и нажать кнопку **Install**.
 4. Пролистайте текст лицензионного соглашения, поставьте галочку в пункте **I accept the terms in the License Agreement** и нажмите **Accept License**.
 5. Повторить шаги 2 - 4 для всех остальных модулей.
 
 ![image](https://github.com/netology-code/pib-homeworks/blob/main/9.1/MES_9.png)
 
**Установка модулей для Ignition завершена!**

</details>

4. Выполните настройку соединения с базой данных (для задания со *).

<details>
 <summary>Подсказка по настройке базы данных для MES (доступна по клику)</summary>

Ignition поддерживает подключения к различным базам данных. Эта база данных будет содержать всю производственную информацию, которая будет запрограммирована инженером по АСУ ТП. И, соответственно, MES-система будет иметь возможность производить запись / чтение этой базы данных.

Для выполнения задания вы будете использовать базу данных MySQL.

Для настройки подключения Ignition к базе данных **необходимо выполнить следующие действия**:

1. Войти на страницу [Ignition Gateway](https://localhost:8088/main/web/home).
2. Перейти на вкладку **Configure** - раздел **Databases - Connections**.
3. Нажать **Create New Database Connection...**.
4. Выбрать тип базы данных **MySQL ConnectorJ** и нажмите **Next** (*После этого у вас отобразится сообщение о том, что отсутствует необходимый JDBC-драйвер. Для решения этой проблемы обратитесь к пунктам «Настройка JDBC-драйвера»*).
5. *Настройка JDBC-драйвера*. Выйдите из меню создания нового соединения и войдите в раздел **Databases - Drivers**.
6. *Настройка JDBC-драйвера*. Найдите в списке драйверов **MySQL** и нажмите **Edit**.
7. *Настройка JDBC-драйвера*. Перейдите по [ссылке](https://dev.mysql.com/downloads/connector/j/), в поле типа операционной системы выберите **Independent System** и нажмите **Download**.
8. *Настройка JDBC-драйвера*. Выгрузите файл .jar в корневой папке скачанного архива.
9. *Настройка JDBC-драйвера*. Вернитесь в открытое окно настройки драйвера. В группе **Main Properties - JAR File(s)** нажмите кнопку **Выберите файл** и в появившемся окне проводника выберите извлеченный вами .jar-файл.
10. *Настройка JDBC-драйвера*. Нажмите **Save Changes** в самом низу экрана и вернитесь к созданию нового соединения. Выполните шаги 3 - 4.
5. Заполните следующие поля:
- **Name:** mes.
- **Connect URL:** jdbc:mysql://localhost:3306/mes.
- **Username:** ххххх (оригинальное имя пользователя, которое вы присваивали базе данных при ее создании).
- **Password:** xxxxx (оригинальный пароль, который вы присваивали базе данных при ее создании).
- **Extra Connection Properties:** serverTimeZone=UTC.
6. Нажмите **Create New Database Connection**
7. Проверьте, что соединение с базой данных работает.
 
<details>
 <summary>Если вы вдруг случайно удалили базу данных в меню **Databases - Drivers**</summary>
 
 Стандартные настройки JDBC-драйвера MySQL:
 
![image](https://github.com/netology-code/pib-homeworks/blob/main/9.1/MES_5.png)
 
Стандартные настройки JDBC-транслятора:
 
 ![image](https://github.com/netology-code/pib-homeworks/blob/main/9.1/MES_6.png)
 
 </details>

**Настройка соединения с базой данных Ignition завершена!**

</details>

5. Выполните настройку шлюза.

<details>
 <summary>Подсказка по настройке шлюза (доступна по клику)</summary>

Ignition Gateway может быть настроен на работу с несколькими базами данных.

Настройка шлюза Ignition Gateway будет заключаться в выборе базы данных, с которой будет связан шлюз. 

Для данной настройки необходимо произвести следующие шаги:

1. Войдите в [Ignition Gateway](https://localhost:8088/main/web/home).
2. Перейдите в **Configure - MES Modules - Settings**.
3. В разделе **Authentication** установите **User Source Profile** в значение *default*.
4. В разделе **Runtime Datasource - Runtime Database** выберите подключение к базе данных *mes*, которое вы создали ранее.
5. В разделе **Analysis Datasource - Analysis Database** также выберите подключение к базе данных *mes*.
6. Нажмите **Save Changes**.

**Настройка Ignition Gateway завершена!**

</details>

6. При необходимости выполните установку TIA Portal 13, PLCSIM 13 (для задания со *):

6.1. Зарегистрируйтесь на [портале Siemens](https://mall.industry.siemens.com/goos/WelcomePage.aspx?regionUrl=/ru&language=ru) и получите персональный логин и пароль для входа в систему. Процесс регистрации описан в [соответствующей инструкции](https://u.netology.ru/backend/uploads/lms/content_assets/file/5522/%D0%A1%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F.xlsx).

6.2. Загрузите и установите программное обеспечение для создания проекта PLC Siemens, входящее в состав пакета TIA Portal с [официального ресурса Siemens](https://support.industry.siemens.com/cs/document/78793685/simatic-step-7-(tia-portal)-v13-trial-download?dti=0&lc=en-DE)
<details>
  <summary> Подсказка по установке TIA Portal 13, PLCSIM 13 (доступна по клику)</summary>
  
  
1. Скачайте все файлы по [ссылке](https://support.industry.siemens.com/cs/document/109745155/simatic-step-7-including-plcsim-v13-sp2-trial-download?dti=0&lc=en-DE) в две отдельные папки:
  - STEP 7 Professional V13 SP2 (DVD 1, DVD 2, SHA-256 checksum)
  ![image](https://github.com/netology-code/phd-homeworks/blob/main/6.6/Step7_1.png)
  - SIMATIC STEP 7 PLCSIM V13 SP2 for STEP 7 Basic and STEP 7 Professional (включая SHA-256 checksum)
    ![image](https://github.com/netology-code/phd-homeworks/blob/main/6.6/Step7_2.png)
2. Запустите установочный файл SIMATIC_STEP_7_Professional_V13_SP2_Upd4.exe, пройдите стандартную процедуру установки.
3. Запустите установочный файл SIMATIC_S7_PLCSIM_V13_SP2.exe, пройдите стандартную процедуру установки.

**Подсказка по распаковке архиватором WinRAR:**

Если скачанный дистрибутив TIA Portal содержит некоторые файлы с расширением 001, это вызовет проблему при распаковке данных.

Это происходит, потому что некоторые версии архиватора WinRAR, установленные на ПК, ассоциируют файлы с именем 001, как файлы с расширением .rar.

Для решения проблемы можно убрать ассоциацию:

1. Найдите архиватор WinRAR, имеющий окончание 001.
2. Откройте его двойным кликом, далее выбирайте Установка ⇒ Интеграция.
3. В окне слева будет перечень форматов, которые по умолчанию ассоциируются с WinRAR.
4. Уберите галочку с формата 001, нажмите ОК и перезагрузите ПК.

Скрин с действиями дан ниже:
 ![image](https://github.com/netology-code/scada-4-homeworks/blob/scada-7/WinRAR.png)

-----
  
</details>
  
*ОБРАТИТЕ ВНИМАНИЕ! Устанавливается демо-версия программы. Её функционал будет ограничен спустя 21 день после установки. Рекомендуется установка софта на виртуальной машине. Как это сделать, описано в [инструкции](https://u.netology.ru/backend/uploads/lms/content_assets/file/339/%D0%98%D0%BD%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%86%D0%B8%D1%8F_%D0%BF%D0%BE_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8E_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%8B_%D0%B8_%D0%BE%D1%82%D0%BA%D0%B0%D1%82%D1%83.pptx).*

------

### Инструкция к заданию

1. Сделайте копию [Шаблона для домашнего задания](https://docs.google.com/document/d/1K3rUI8rT765rX8p8fIarlTpN6ImvCCwxKgTG7-2a_cs/edit?usp=sharing) себе на Google Диске.
2. В названии файла введите вашу фамилию и имя.
3. Зайдите в «Настройки доступа» и выберите доступ «Просматривать могут все в Интернете, у кого есть ссылка». Ссылка на инструкцию [Как предоставить доступ к файлам и папкам на Google Диске](https://support.google.com/docs/answer/2494822?hl=ru&co=GENIE.Platform%3DDesktop).
4. Скопируйте текст задания в свой документ.
5. Выполните домашнее задание.
6. Вставьте в соответствующие абзацы вашего документа ссылки на выполненные задания.
7. Для проверки домашнего задания преподавателем отправьте ссылку на ваш документ в личном кабинете.
8. Любые вопросы по решению задач задавайте в чате учебной группы.

------

### Инструменты/ дополнительные материалы, которые пригодятся для выполнения задания

1. [MES Ignition](https://inductiveautomation.com/downloads/)
2. [MySQL Server](https://dev.mysql.com/downloads/windows/installer/8.0.html)
3. [MySQL Workbench](https://dev.mysql.com/downloads/workbench/)
4. [MySQL ConnectorJ](https://dev.mysql.com/downloads/connector/j/)
5. [MES-модули](https://www.sepasoft.com/downloads/)
6. [Шаблон для домашнего задания](https://docs.google.com/document/d/1K3rUI8rT765rX8p8fIarlTpN6ImvCCwxKgTG7-2a_cs/edit?usp=sharing)
7. [Инструкция по установке Ignition Designer](https://docs.google.com/presentation/d/1FoGLMRbFHt9x21JoDXvSH3CWbL26916vyjqArkmyS3Y/edit?usp=sharing)
8. [TIA Portal 13, PLCSIM 13](https://support.industry.siemens.com/cs/document/109745155/simatic-step-7-including-plcsim-v13-sp2-trial-download?dti=0&lc=en-WW)

------

### Задание 1. Работа с Ignition Designer

1. Установите инструмент для создания визуализации Ignition Designer. Инструкция по установке данного ПО размещена [здесь](https://docs.google.com/presentation/d/1FoGLMRbFHt9x21JoDXvSH3CWbL26916vyjqArkmyS3Y/edit?usp=sharing).
2. **Создайте экран управления со следующим инструментарием:**
- кнопка открытия пневмоцилиндра 1
- кнопка закрытия пневмоцилиндра 1
- кнопка открытия пневмоцилиндра 2
- кнопка закрытия пневмоцилиндра 2
- кнопка открытия пневмоцилиндра 3
- кнопка закрытия пневмоцилиндра 3
- текст статусов пнемоцилиндров - открыт, закрыт, неопределённое положение (отображаемые тексты статусов можете менять по своему усмотрению с сохранением смысла)
- изображения пневмоцилиндров
- статусы, представленные в виде ламп, меняющих цвет в случае изменения статусов (*зелёный - открытие/закрытие прошло успешно, красный - ошибка открытия/закрытия)
- поле ввода данных о номере программы и кнопку «Запустить программу».
3. **Создайте экран настроек программы со следующим инструментарием**:
- поле ввода номера цилиндра, который будет работать первым
- поле ввода номера цилиндра, который будет работать вторым
- поле ввода номера цилиндра, который будет работать третьим
- поле ввода времени открытия цилиндра 1
- поле ввода времени закрытия цилиндра 1
- поле ввода времени открытия цилиндра 2
- поле ввода времени закрытия цилиндра 2
- поле ввода времени открытия цилиндра 3
- поле ввода времени закрытия цилиндра 3.

*Результатом выполнения данного задания будет следующий набор снимков экрана:*

*- снимок экрана ручного управления (п.2)*

*- снимок экрана настроек (п.3)*

------

### Задание 2 *. Связь ПЛК с базой данных Ignition (необязательное задание)

Настройте связь с PLC Siemens. **Для этого выполните следующие действия:**
1. Настройте базу данных в соответствии с инструкцией выше.
2. Создайте новый проект в TIA Portal V13 и добавьте в аппаратную конфигурацию PLC S7-1500 (точную маркироку контроллера выберите самостоятельно).
3. Создайте теги, соответствующие всем тегам в Ignition.
4. Создайте программные блоки с алгоритмом обработки команд экранов.
5. Настройте связь PLC c Ignition Gateway.
6. Форсируйте значения статусов из симулятора PLCSIM. Значения должны поменяться в базе данных и на экране.

*Результатом выполнения данного задания будет следующий набор данных:*

*- проект, созданный в TIA Portal (в формате .zap13)*

*- снимок экрана базы данных до и после форсирования переменных из ПЛК*

*- снимок экрана статусов цилиндров до и после форсирования переменных из ПЛК.*

------

### Правила приёма работы

1. Отправлена ссылка на документ (Google Doc) с выполненным заданием в личном кабинете.
2. Документ размещён на личном Google Диске.
3. К документу настроены права доступа «Просматривать могут все в Интернете, у кого есть ссылка».

------

### Критерии оценки

1. Зачёт - выполнены все задания, ответы даны в развёрнутой форме, в выполненных заданиях нет противоречий и нарушения логики.
2. На доработку - задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.
